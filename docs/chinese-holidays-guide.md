# ä¸­å›½æ³•å®šèŠ‚å‡æ—¥é›†æˆæŒ‡å—

## åŠŸèƒ½è¯´æ˜

æœ¬ç³»ç»Ÿå·²é›†æˆä¸­å›½æ³•å®šèŠ‚å‡æ—¥å’Œå‘¨æœ«è°ƒä¼‘æ ‡è®°åŠŸèƒ½ï¼Œå¯ä»¥åœ¨æ—¥å†ä¸­æ˜¾ç¤ºï¼š

- ğŸ”´ **èŠ‚å‡æ—¥æ ‡è®°**ï¼šä»¥çº¢è‰²"ä¼‘"æ ‡è¯†ï¼Œå•å…ƒæ ¼èƒŒæ™¯æ·¡çº¢è‰²
- ğŸŸ  **è°ƒä¼‘è¡¥ç­æ ‡è®°**ï¼šä»¥æ©™è‰²"ç­"æ ‡è¯†ï¼Œå•å…ƒæ ¼èƒŒæ™¯æ·¡æ©™è‰²

## æ•°æ®æ¥æº

èŠ‚å‡æ—¥æ•°æ®å­˜å‚¨åœ¨ [`src/lib/chinese-holidays.ts`](../src/lib/chinese-holidays.ts) æ–‡ä»¶ä¸­ï¼ŒåŒ…æ‹¬ï¼š

- **2026å¹´**ï¼šåŸºäºå›½åŠ¡é™¢åŠå…¬å…2025å¹´11æœˆå‘å¸ƒçš„å®˜æ–¹èŠ‚å‡æ—¥å®‰æ’
- **2027å¹´åŠä»¥å**ï¼šé¢„æµ‹æ•°æ®ï¼Œéœ€è¦åœ¨æ¯å¹´11æœˆ30æ—¥æ ¹æ®å®˜æ–¹å‘å¸ƒæ›´æ–°

## æ˜¾ç¤ºæ•ˆæœ

### 1. æœˆè§†å›¾
- èŠ‚å‡æ—¥æ—¥æœŸæ˜¾ç¤ºçº¢è‰²"ä¼‘"å¾½ç« 
- è°ƒä¼‘è¡¥ç­æ—¥æœŸæ˜¾ç¤ºæ©™è‰²"ç­"å¾½ç« 
- å•å…ƒæ ¼èƒŒæ™¯è‰²åŒºåˆ†ï¼ˆèŠ‚å‡æ—¥æ·¡çº¢è‰²ï¼Œè°ƒä¼‘æ·¡æ©™è‰²ï¼‰

### 2. å‘¨è§†å›¾å’Œæ—¥è§†å›¾
- åˆ—æ ‡é¢˜æ˜¾ç¤ºèŠ‚å‡æ—¥å¾½ç« 
- èƒŒæ™¯è‰²è¾…åŠ©æ ‡è¯†

### 3. æ‚¬åœæç¤º
- é¼ æ ‡æ‚¬åœåœ¨å¾½ç« ä¸Šæ˜¾ç¤ºèŠ‚å‡æ—¥åç§°ï¼ˆå¦‚"æ˜¥èŠ‚"ã€"åŠ³åŠ¨èŠ‚"ç­‰ï¼‰

## æ•°æ®æ›´æ–°æœºåˆ¶

### è‡ªåŠ¨æ£€æŸ¥è„šæœ¬

ä½¿ç”¨ [`scripts/check-holiday-update.ts`](../scripts/check-holiday-update.ts) è„šæœ¬è‡ªåŠ¨æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°ï¼š

```bash
# æ‰‹åŠ¨è¿è¡Œæ£€æŸ¥
tsx scripts/check-holiday-update.ts
```

**è„šæœ¬åŠŸèƒ½**ï¼š
- æ¯å¹´11æœˆ30æ—¥è§¦å‘æé†’
- è‡ªåŠ¨å°è¯•ä»APIè·å–ä¸‹ä¸€å¹´æ•°æ®
- è¾“å‡ºè¯¦ç»†çš„æ›´æ–°æ­¥éª¤è¯´æ˜
- å¯é€‰ï¼šå‘é€é’‰é’‰é€šçŸ¥ï¼ˆéœ€é…ç½® DINGTALK_WEBHOOK_URLï¼‰

### è®¾ç½®å®šæ—¶ä»»åŠ¡

#### Linux/macOS (Cron)

ç¼–è¾‘ crontabï¼š
```bash
crontab -e
```

æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯å¤©ä¸Šåˆ9ç‚¹æ£€æŸ¥ï¼‰ï¼š
```
0 9 * 11 * cd /home/carter/calendar && tsx scripts/check-holiday-update.ts
```

#### Windows (ä»»åŠ¡è®¡åˆ’ç¨‹åº)

1. æ‰“å¼€"ä»»åŠ¡è®¡åˆ’ç¨‹åº"
2. åˆ›å»ºåŸºæœ¬ä»»åŠ¡
3. è§¦å‘å™¨ï¼šæ¯å¹´11æœˆ30æ—¥
4. æ“ä½œï¼šå¯åŠ¨ç¨‹åº
   - ç¨‹åºï¼š`C:\Program Files\nodejs\node.exe`
   - å‚æ•°ï¼š`./node_modules/.bin/tsx scripts/check-holiday-update.ts`
   - èµ·å§‹äºï¼šé¡¹ç›®æ ¹ç›®å½•

### API ç«¯ç‚¹

è®¿é—® `/api/holidays/check-update` æ£€æŸ¥æ›´æ–°çŠ¶æ€ï¼š

```bash
# GET - æ£€æŸ¥æ˜¯å¦éœ€è¦æ›´æ–°
curl http://localhost:5000/api/holidays/check-update

# POST - è·å–æŒ‡å®šå¹´ä»½çš„èŠ‚å‡æ—¥æ•°æ®
curl -X POST http://localhost:5000/api/holidays/check-update \
  -H "Content-Type: application/json" \
  -d '{"year": 2027}'
```

## æ‰‹åŠ¨æ›´æ–°æ­¥éª¤

### 1. è·å–å®˜æ–¹æ•°æ®

**å®˜æ–¹æ¥æº**ï¼š
- å›½åŠ¡é™¢åŠå…¬å…å®˜ç½‘ï¼šhttp://www.gov.cn/
- æœç´¢å…³é”®è¯ï¼š"2027å¹´èŠ‚å‡æ—¥å®‰æ’"

**ç¬¬ä¸‰æ–¹API**ï¼ˆå¯é€‰ï¼‰ï¼š
```bash
# Timor API
curl https://timor.tech/api/holiday/year/2027

# APIHubs
curl https://api.apihubs.cn/holiday/get?year=2027
```

### 2. æ›´æ–°æ•°æ®æ–‡ä»¶

ç¼–è¾‘ [`src/lib/chinese-holidays.ts`](../src/lib/chinese-holidays.ts)ï¼š

```typescript
export const holidays2027: HolidayData[] = [
  // å…ƒæ—¦
  { date: '2027-01-01', name: 'å…ƒæ—¦', isHoliday: true, holidayType: 'new-year' },
  { date: '2027-01-02', name: 'å…ƒæ—¦', isHoliday: true, holidayType: 'new-year' },
  { date: '2027-01-03', name: 'å…ƒæ—¦', isHoliday: true, holidayType: 'new-year' },

  // è°ƒä¼‘è¡¥ç­æ—¥ï¼ˆé‡è¦ï¼ï¼‰
  { date: '2027-01-31', name: 'æ˜¥èŠ‚è°ƒä¼‘', isHoliday: false, holidayType: 'spring-festival' },

  // ... å…¶ä»–èŠ‚å‡æ—¥
]
```

**æ³¨æ„äº‹é¡¹**ï¼š
- âœ… `isHoliday: true` - èŠ‚å‡æ—¥ï¼ˆä¼‘æ¯ï¼‰
- âœ… `isHoliday: false` - è°ƒä¼‘è¡¥ç­æ—¥ï¼ˆä¸Šç­ï¼‰
- âœ… æ—¥æœŸæ ¼å¼ï¼š`YYYY-MM-DD`
- âœ… ç¡®ä¿åŒ…å«æ‰€æœ‰è°ƒä¼‘æ—¥æœŸ

### 3. æµ‹è¯•éªŒè¯

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev

# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€æ—¥å†
# æ£€æŸ¥ä»¥ä¸‹å†…å®¹ï¼š
# - èŠ‚å‡æ—¥æ˜¯å¦æ­£ç¡®æ˜¾ç¤ºçº¢è‰²"ä¼‘"å¾½ç« 
# - è°ƒä¼‘æ—¥æ˜¯å¦æ­£ç¡®æ˜¾ç¤ºæ©™è‰²"ç­"å¾½ç« 
# - å•å…ƒæ ¼èƒŒæ™¯è‰²æ˜¯å¦æ­£ç¡®
# - æ‚¬åœæç¤ºæ˜¯å¦æ˜¾ç¤ºèŠ‚å‡æ—¥åç§°
```

## èŠ‚å‡æ—¥ç±»å‹è¯´æ˜

| ç±»å‹ | holidayType å€¼ | ç¤ºä¾‹ |
|------|----------------|------|
| å…ƒæ—¦ | `new-year` | 1æœˆ1-3æ—¥ |
| æ˜¥èŠ‚ | `spring-festival` | å†œå†æ­£æœˆåˆä¸€å‰å7å¤© |
| æ¸…æ˜èŠ‚ | `qingming` | 4æœˆ4-6æ—¥ |
| åŠ³åŠ¨èŠ‚ | `labor-day` | 5æœˆ1-5æ—¥ |
| ç«¯åˆèŠ‚ | `dragon-boat` | å†œå†äº”æœˆåˆäº”å‰å3å¤© |
| ä¸­ç§‹èŠ‚ | `mid-autumn` | å†œå†å…«æœˆåäº”å‰å3å¤© |
| å›½åº†èŠ‚ | `national-day` | 10æœˆ1-7æ—¥ |

## å¸¸è§é—®é¢˜

### Q1: å¦‚ä½•åˆ¤æ–­æŸä¸€å¤©æ˜¯å¦æ˜¯èŠ‚å‡æ—¥ï¼Ÿ

```typescript
import { isHoliday, isWorkday, getHolidayInfo } from '@/lib/chinese-holidays'

// æ£€æŸ¥æ˜¯å¦æ˜¯èŠ‚å‡æ—¥ï¼ˆä¼‘æ¯æ—¥ï¼‰
const isRest = isHoliday('2026-01-01') // true

// æ£€æŸ¥æ˜¯å¦æ˜¯è°ƒä¼‘è¡¥ç­æ—¥
const isWork = isWorkday('2026-02-14') // true

// è·å–è¯¦ç»†ä¿¡æ¯
const info = getHolidayInfo('2026-01-01')
// { date: '2026-01-01', name: 'å…ƒæ—¦', isHoliday: true, holidayType: 'new-year' }
```

### Q2: ä¸ºä»€ä¹ˆ2027å¹´çš„æ•°æ®æ˜¯"é¢„æµ‹"ï¼Ÿ

å› ä¸ºå›½åŠ¡é™¢é€šå¸¸åœ¨æ¯å¹´11æœˆåº•æ‰å‘å¸ƒä¸‹ä¸€å¹´çš„å…·ä½“èŠ‚å‡æ—¥å®‰æ’ï¼ŒåŒ…æ‹¬è°ƒä¼‘æ—¥æœŸã€‚é¢„æµ‹æ•°æ®åŸºäºä¼ ç»ŸèŠ‚æ—¥æ—¥æœŸå’Œå†å¹´æƒ¯ä¾‹ï¼Œä½†è°ƒä¼‘å®‰æ’å¯èƒ½ä¸å‡†ç¡®ã€‚

### Q3: å¦‚ä½•æ·»åŠ æ–°å¹´ä»½çš„æ•°æ®ï¼Ÿ

1. åœ¨ `chinese-holidays.ts` ä¸­æ·»åŠ æ–°çš„æ•°ç»„ï¼ˆå¦‚ `holidays2028`ï¼‰
2. å°†æ–°æ•°ç»„æ·»åŠ åˆ° `allHolidays`ï¼š
   ```typescript
   export const allHolidays: HolidayData[] = [
     ...holidays2026,
     ...holidays2027,
     ...holidays2028, // æ–°å¢
   ]
   ```

### Q4: é’‰é’‰é€šçŸ¥å¦‚ä½•é…ç½®ï¼Ÿ

åœ¨ç¯å¢ƒå˜é‡ä¸­æ·»åŠ ï¼š
```bash
# .env.local
DINGTALK_WEBHOOK_URL=https://oapi.dingtalk.com/robot/send?access_token=YOUR_TOKEN
```

ç„¶åè„šæœ¬ä¼šè‡ªåŠ¨åœ¨æ£€æŸ¥åˆ°éœ€è¦æ›´æ–°æ—¶å‘é€é€šçŸ¥ã€‚

## æŠ€æœ¯å®ç°

### æ—¥å†ç»„ä»¶é›†æˆ

åœ¨ [`src/components/event-calendar.tsx`](../src/components/event-calendar.tsx) ä¸­ï¼š

```typescript
import { getHolidayInfo } from "@/lib/chinese-holidays"

const handleDayCellDidMount = (info: any) => {
  const date = info.date
  const holidayInfo = getHolidayInfo(date)

  if (holidayInfo) {
    // æ·»åŠ å¾½ç« å’Œæ ·å¼
  }
}
```

### æ ·å¼å®šä¹‰

åœ¨ [`src/components/event-calendar.css`](../src/components/event-calendar.css) ä¸­ï¼š

- `.holiday-badge` - çº¢è‰²èŠ‚å‡æ—¥å¾½ç« 
- `.workday-badge` - æ©™è‰²è°ƒä¼‘å¾½ç« 
- `.holiday-cell` - èŠ‚å‡æ—¥å•å…ƒæ ¼èƒŒæ™¯
- `.workday-cell` - è°ƒä¼‘å•å…ƒæ ¼èƒŒæ™¯

## æ›´æ–°è®°å½•

| æ—¥æœŸ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| 2026-02-11 | 1.0 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŒ…å«2026å¹´å®˜æ–¹æ•°æ®å’Œ2027å¹´é¢„æµ‹æ•°æ® |

---

**æé†’**ï¼šè¯·åœ¨æ¯å¹´11æœˆ30æ—¥æ£€æŸ¥å¹¶æ›´æ–°ä¸‹ä¸€å¹´çš„èŠ‚å‡æ—¥æ•°æ®ï¼
